---
title: "Shining Star Indoor/Outdoor Data Outlier Filtering"
author: "Megan Ku"
---
# Description

This code filters data from the Shining Star pilot, removing 
outliers.

# Environment Setup 

Beforehand, we will import the necessary libraries. 

```{r, warning= FALSE, error = FALSE}
library(lubridate) #date and time functions 
library(data.table) #to use the data.table variable type
library(dplyr) #this library allows you to use the %>% operator
library(tidyr) # use the complete function to account for time syncing
library(openair) #for plotting and analysis
library(stringr)
library(ggplot2)
library(gtable)
library(grid)
source("../filter_data.R") #For filtering data
```

# Import Data

```{r}
front_merged <- import_ratio_data("../data/merged/SS_front_merged.csv")
infant_merged <- import_ratio_data("../data/merged/SS_infant_merged.csv")
kitchen_merged <- import_ratio_data("../data/merged/SS_kitchen_merged.csv")
preschool_merged <- import_ratio_data("../data/merged/SS_preschool_merged.csv")
toddler_merged <- import_ratio_data("../data/merged/SS_toddler_merged.csv")
```


Now we will plot all the time series to investigate any data point anomalies.

```{r, fig.height=10}
plot_time_resolved(front_merged, FALSE)
plot_time_resolved(infant_merged, TRUE)
plot_time_resolved(kitchen_merged, FALSE)
plot_time_resolved(preschool_merged, TRUE)
plot_time_resolved(toddler_merged, FALSE)
```
# Removing Outliers

We're going to manually remove outliers from each dataset according to visual 
cues, including the presence of indoor sources (a sharp increase followed by a 
decay) and RF interference (sharp concentrated spikes much higher than the 
underlying trend).

## Outdoor

```{r}
front <- set_NA(front_merged, "2021-04-19 11:27:00", "2021-04-19 11:59:00")
infant <- set_NA(infant_merged, "2021-04-19 11:27:00", "2021-04-19 11:59:00")
kitchen <- set_NA(kitchen_merged, "2021-04-19 11:27:00", "2021-04-19 11:59:00")
preschool <- set_NA(preschool_merged, "2021-04-19 11:27:00", "2021-04-19 11:59:00")
toddler <- set_NA(toddler_merged, "2021-04-19 11:27:00", "2021-04-19 11:59:00")

front <- set_NA(front, "2021-04-19 10:44:00", "2021-04-19 11:04:00")
infant <- set_NA(infant, "2021-04-19 10:44:00", "2021-04-19 11:04:00")
kitchen <- set_NA(kitchen, "2021-04-19 10:44:00", "2021-04-19 11:04:00")
preschool <- set_NA(preschool, "2021-04-19 10:44:00", "2021-04-19 11:04:00")
toddler <- set_NA(toddler, "2021-04-19 10:44:00", "2021-04-19 11:04:00")

front <- set_NA(front, "2021-04-22 07:36:00", "2021-04-22 07:38:00")
infant <- set_NA(infant, "2021-04-22 07:36:00", "2021-04-22 07:38:00")
kitchen <- set_NA(kitchen, "2021-04-22 07:36:00", "2021-04-22 07:38:00")
preschool <- set_NA(preschool, "2021-04-22 07:36:00", "2021-04-22 07:38:00")
toddler <- set_NA(toddler, "2021-04-22 07:36:00", "2021-04-22 07:38:00")

front <- set_NA(front, "2021-04-22 12:14:00", "2021-04-22 12:16:00")
infant <- set_NA(infant, "2021-04-22 12:14:00", "2021-04-22 12:16:00")
kitchen <- set_NA(kitchen, "2021-04-22 12:14:00", "2021-04-22 12:16:00")
preschool <- set_NA(preschool, "2021-04-22 12:14:00", "2021-04-22 12:16:00")
toddler <- set_NA(toddler, "2021-04-22 12:14:00", "2021-04-22 12:16:00")
```


## Indoor data

With the indoor data, we sought to identify and remove signs of indoor sources
of particulate matter and UFPs. These can be identified by a sharp spike in the 
indoor particle concentrations, followed by a return to background levels. Note 
that these spikes have no correlated increases in the outdoor data, leading to 
the conclusion that the particles were generated indoors

There are two notable shapes that suggest the presence of an indoor source:
1. Cleaning - this can be identified by a spike in larger particle
concentrations indoors (PM10 primarily, PM2.5 secondarily).

2. Fine particle source - a fine particle source is easily noticeable by its 
shape - a near vertical spike upward followed by an exponential decay. This
spike is noticeable across all particle sizes.

We omit instances of these source spikes, including their related outdoor data, 
in this step. For fine particle sources, we store only the decay portion of the 
event for further analysis.

### Front

```{r, fig.height=10}
plot_time_resolved(front_merged, FALSE)
plot_time_resolved(front, FALSE)

# Fine particle source - 4/16
front_indoor_src <- front[
  front$date1min > as.POSIXct("2021-04-16 08:49:00", tz='America/New_York') &
  front$date1min < as.POSIXct("2021-04-16 13:20:00", tz='America/New_York'), ]

front_filt <- set_NA(front, "2021-04-16 08:41:00", "2021-04-16 13:20:00")

# Fine particle source - 4/20
front_indoor_src <- rbind(front_indoor_src, front[
  front$date1min > as.POSIXct("2021-04-20 10:56:00", tz='America/New_York') &
  front$date1min < as.POSIXct("2021-04-20 19:20:00", tz='America/New_York'), ])

front_filt <- set_NA(front_filt, "2021-04-20 10:44:00", "2021-04-20 19:20:00")

front_indoor_src <- complete(front_indoor_src, date1min = seq(min(front_filt$date1min, na.rm=TRUE), 
                                    max(front_filt$date1min, na.rm=TRUE), 
                                    by = "min"))

plot_time_resolved(front_filt, FALSE)
plot_time_resolved(front_indoor_src, FALSE)
```
### Infant
```{r, fig.height=10}
plot_time_resolved(infant_merged, TRUE)
plot_time_resolved(infant, TRUE)

# Fine particle sources - 4/7
infant_indoor_src <- infant[
  infant$date1min > as.POSIXct("2021-04-07 10:53:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-07 13:13:00", tz='America/New_York'), ]

infant_filt <- set_NA(infant, "2021-04-07 10:13:00", "2021-04-07 13:13:00")

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-07 17:05:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-07 17:34:00", tz='America/New_York'), ])

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-07 17:50:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-07 18:23:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-07 16:32:00", "2021-04-07 18:23:00")

# Fine particle source - 4/8
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-08 10:24:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-08 13:49:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-08 06:45:00", "2021-04-08 13:49:00")

# Fine particle source - 4/9
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-09 07:19:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-09 08:36:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-09 07:09:00", "2021-04-09 10:05:00")

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-09 11:24:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-09 12:52:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-09 10:55:00", "2021-04-09 12:52:00")

# Fine particle source - 4/10
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-10 08:12:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-10 08:54:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-10 08:09:00", "2021-04-10 08:54:00")

# Fine particle sources - 4/12-4/13
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-12 09:14:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-12 14:29:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-12 07:29:00", "2021-04-12 14:29:00")

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-12 23:11:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-13 02:30:00", tz='America/New_York'), ])

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-13 10:08:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-13 14:30:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-12 19:28:00", "2021-04-13 14:30:00")

# Fine particle source - 4/14
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-14 11:35:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-14 14:10:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-14 00:21:00", "2021-04-14 14:25:00")

# Fine particle source - 4/15
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-15 08:42:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-15 10:01:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-15 07:13:00", "2021-04-15 13:50:00")

# Fine particle source - 4/16
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-16 08:34:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-16 11:46:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-16 07:20:00", "2021-04-16 13:05:00")

# Fine particle source - 4/18
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-18 10:23:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-18 12:23:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-18 10:06:00", "2021-04-18 12:23:00")

# Fine particle source - 4/20
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-20 08:17:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-20 09:41:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-20 07:05:00", "2021-04-20 09:41:00")

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-20 10:59:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-20 14:43:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-20 10:04:00", "2021-04-20 14:43:00")

# Fine particle source - 4/21
infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-21 08:44:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-21 10:26:00", tz='America/New_York'), ])

infant_indoor_src <- rbind(infant_indoor_src, infant[
  infant$date1min > as.POSIXct("2021-04-21 10:48:00", tz='America/New_York') &
  infant$date1min < as.POSIXct("2021-04-21 12:13:00", tz='America/New_York'), ])

infant_filt <- set_NA(infant_filt, "2021-04-21 07:12:00", "2021-04-21 12:13:00")


infant_indoor_src <- complete(infant_indoor_src, date1min = seq(min(infant_filt$date1min, na.rm=TRUE), 
                                    max(infant_filt$date1min, na.rm=TRUE), 
                                    by = "min"))

plot_time_resolved(infant_filt, TRUE)
plot_time_resolved(infant_indoor_src, TRUE)
```


### Kitchen

```{r, fig.height=10}
plot_time_resolved(kitchen, FALSE)

# Cleaning source - 4/7
kitchen_filt <- set_NA(kitchen, "2021-04-07 10:05:00", "2021-04-07 11:05:00")

kitchen_indoor_src <- kitchen[
  kitchen$date1min > as.POSIXct("2021-04-07 11:49:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-07 12:33:00", tz='America/New_York'), ]

kitchen_filt <- set_NA(kitchen_filt, "2021-04-07 11:49:00", "2021-04-07 12:33:00")

kitchen_filt <- set_NA(kitchen_filt, "2021-04-07 16:14:00", "2021-04-07 16:33:00")

# Cleaning source - 4/8
kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-08 08:29:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-08 08:41:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-08 07:24:00", "2021-04-08 08:41:00")

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-08 09:36:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-08 10:02:00", tz='America/New_York'), ])

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-08 10:04:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-08 10:12:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-08 09:29:00", "2021-04-08 12:28:00")

# Fine particle source - 4/12

kitchen_filt <- set_NA(kitchen_filt, "2021-04-12 07:17:00", "2021-04-12 09:42:00")

# Fine particle source - 4/13

kitchen_filt <- set_NA(kitchen_filt, "2021-04-13 08:02:00", "2021-04-13 16:21:00")

# Fine particle source - 4/14

kitchen_filt <- set_NA(kitchen_filt, "2021-04-14 07:00:00", "2021-04-14 13:14:00")

# Fine particle source - 4/15

kitchen_filt <- set_NA(kitchen_filt, "2021-04-15 07:17:00", "2021-04-15 12:46:00")

# Fine particle source - 4/16

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-16 08:49:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-16 10:35:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-16 07:31:00", "2021-04-16 13:39:00")

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-16 16:37:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-16 16:56:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-16 16:28:00", "2021-04-16 16:56:00")

# Fine particle source - 4/17

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-17 07:18:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-17 07:37:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-17 07:17:00", "2021-04-17 07:37:00")

# Fine particle source - 4/18
kitchen_filt <- set_NA(kitchen_filt, "2021-04-18 10:22:00", "2021-04-18 10:37:00")


# Fine particle source - 4/20

kitchen_indoor_src <- rbind(kitchen_indoor_src, kitchen[
  kitchen$date1min > as.POSIXct("2021-04-20 08:13:00", tz='America/New_York') &
  kitchen$date1min < as.POSIXct("2021-04-20 08:28:00", tz='America/New_York'), ])

kitchen_filt <- set_NA(kitchen_filt, "2021-04-20 07:09:00", "2021-04-20 12:43:00")


# Fine particle source - 4/21

kitchen_filt <- set_NA(kitchen_filt, "2021-04-21 07:13:00", "2021-04-21 12:30:00")
kitchen_filt <- set_NA(kitchen_filt, "2021-04-21 16:18:00", "2021-04-21 16:40:00")

# cleaning - 4/22

kitchen_filt <- set_NA(kitchen_filt, "2021-04-22 07:00:00", "2021-04-22 07:35:00")
kitchen_filt <- set_NA(kitchen_filt, "2021-04-22 09:17:00", "2021-04-22 10:30:00")
kitchen_filt <- set_NA(kitchen_filt, "2021-04-22 13:56:00", "2021-04-22 14:16:00")

# Fine particle source - 4/23

kitchen_filt <- set_NA(kitchen_filt, "2021-04-23 07:26:00", "2021-04-23 12:31:00")



kitchen_indoor_src <- complete(kitchen_indoor_src, date1min = seq(min(kitchen_filt$date1min, na.rm=TRUE), 
                                    max(kitchen_filt$date1min, na.rm=TRUE), 
                                    by = "min"))
plot_time_resolved(kitchen_filt, FALSE)
plot_time_resolved(kitchen_indoor_src, FALSE)
```

### Preschool

```{r, fig.height=10}
plot_time_resolved(preschool, TRUE)

preschool_filt <- set_NA(preschool, "2021-04-07 08:50:00", "2021-04-07 13:30:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-08 07:05:00", "2021-04-08 13:15:00")

preschool_indoor_src <- preschool[
  preschool$date1min > as.POSIXct("2021-04-09 11:26:00", tz='America/New_York') &
  preschool$date1min < as.POSIXct("2021-04-09 14:12:00", tz='America/New_York'), ]

preschool_filt <- set_NA(preschool_filt, "2021-04-09 07:08:00", "2021-04-09 14:12:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-12 07:09:00", "2021-04-12 12:50:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-13 08:01:00", "2021-04-13 14:01:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-14 07:00:00", "2021-04-14 14:58:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-15 07:14:00", "2021-04-15 12:19:00")

preschool_indoor_src <- rbind(preschool_indoor_src, preschool[
  preschool$date1min > as.POSIXct("2021-04-16 11:29:00", tz='America/New_York') &
  preschool$date1min < as.POSIXct("2021-04-16 14:52:00", tz='America/New_York'), ])

preschool_filt <- set_NA(preschool_filt, "2021-04-16 07:18:00", "2021-04-16 14:52:00")

preschool_indoor_src <- rbind(preschool_indoor_src, preschool[
  preschool$date1min > as.POSIXct("2021-04-18 11:11:00", tz='America/New_York') &
  preschool$date1min < as.POSIXct("2021-04-18 13:15:00", tz='America/New_York'), ])

preschool_filt <- set_NA(preschool_filt, "2021-04-18 10:05:00", "2021-04-18 13:15:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-20 07:02:00", "2021-04-20 14:00:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-21 07:10:00", "2021-04-21 11:42:00")

preschool_filt <- set_NA(preschool_filt, "2021-04-22 03:19:00", "2021-04-22 04:54:00")



preschool_indoor_src <- complete(preschool_indoor_src, date1min = seq(min(preschool_filt$date1min, na.rm=TRUE), 
                                    max(preschool_filt$date1min, na.rm=TRUE), 
                                    by = "min"))

plot_time_resolved(preschool_filt, TRUE)
plot_time_resolved(preschool_indoor_src, TRUE)
```



### Toddler

```{r, fig.height=10}
plot_time_resolved(toddler, FALSE)

toddler_filt <- set_NA(toddler, "2021-04-07 11:14:00", "2021-04-07 13:17:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-08 07:37:00", "2021-04-08 13:32:00")

toddler_indoor_src <- toddler[
  toddler$date1min > as.POSIXct("2021-04-09 10:03:00", tz='America/New_York') &
  toddler$date1min < as.POSIXct("2021-04-09 11:38:00", tz='America/New_York'), ]

toddler_filt <- set_NA(toddler_filt, "2021-04-09 09:41:00", "2021-04-09 11:38:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-09 17:02:00", "2021-04-09 17:16:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-12 07:15:00", "2021-04-12 07:32:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-12 10:05:00", "2021-04-12 13:17:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-12 15:25:00", "2021-04-12 15:54:00")

toddler_indoor_src <- rbind(toddler_indoor_src, toddler[
  toddler$date1min > as.POSIXct("2021-04-13 12:36:00", tz='America/New_York') &
  toddler$date1min < as.POSIXct("2021-04-13 16:43:00", tz='America/New_York'), ])

toddler_filt <- set_NA(toddler_filt, "2021-04-13 07:00:00", "2021-04-13 16:43:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-14 09:35:00", "2021-04-14 10:10:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-14 12:14:00", "2021-04-14 13:05:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-15 06:56:00", "2021-04-15 13:16:00")

toddler_indoor_src <- rbind(toddler_indoor_src, toddler[
  toddler$date1min > as.POSIXct("2021-04-16 09:03:00", tz='America/New_York') &
  toddler$date1min < as.POSIXct("2021-04-16 11:49:00", tz='America/New_York'), ])

toddler_filt <- set_NA(toddler_filt, "2021-04-16 08:42:00", "2021-04-16 13:00:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-16 16:49:00", "2021-04-16 17:04:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-20 13:02:00", "2021-04-20 13:13:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-22 11:18:00", "2021-04-22 11:38:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-22 11:56:00", "2021-04-22 12:35:00")

toddler_filt <- set_NA(toddler_filt, "2021-04-23 08:13:00", "2021-04-23 09:13:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-23 11:17:00", "2021-04-23 11:24:00")
toddler_filt <- set_NA(toddler_filt, "2021-04-23 12:23:00", "2021-04-23 13:02:00")


toddler_indoor_src <- complete(toddler_indoor_src, date1min = seq(min(toddler_filt$date1min, na.rm=TRUE), 
                                    max(toddler_filt$date1min, na.rm=TRUE), 
                                    by = "min"))


plot_time_resolved(toddler_filt, FALSE)
plot_time_resolved(toddler_indoor_src, FALSE)
```



```{r}
filtered <- list(
  "SS_front_filt" = front_filt,
  "SS_infant_filt" = infant_filt,
  "SS_kitchen_filt" = kitchen_filt,
  "SS_preschool_filt" = preschool_filt,
  "SS_toddler_filt" = toddler_filt)

indoor_src <- list(
  "SS_front_indoor_src" = front_indoor_src,
  "SS_infant_indoor_src" = infant_indoor_src,
  "SS_kitchen_indoor_src" = kitchen_indoor_src,
  "SS_preschool_indoor_src" = preschool_indoor_src,
  "SS_toddler_indoor_src" = toddler_indoor_src)

mapply(
  write.table, #apply function write table
  x=indoor_src, file=paste("../data/indoor_src", paste(names(indoor_src), "csv", sep="."), sep="/"), #for each dataframe, use its name to make a csv of it
  MoreArgs=list(row.names=FALSE, sep=",")
)
mapply(
  write.table, #apply function write table
  x=filtered, file=paste("../data/filtered", paste(names(filtered), "csv", sep="."), sep="/"), #for each dataframe, use its name to make a csv of it
  MoreArgs=list(row.names=FALSE, sep=",")
)
```


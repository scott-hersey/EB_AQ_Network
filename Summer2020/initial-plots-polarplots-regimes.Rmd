---
title : "Initial Plots"
---

#Overview 

After completing the data cleaning, I use this document to create the initial graphs discussed in the Figure Planning document 

# Setup 

```{r}
library(lubridate)
library(openair)
library(data.table)
```


```{r}
sn45 <- read.csv("data/sn45filt.csv", header= TRUE)
sn45$date <- ymd_hms(sn45$date,  tz = "America/New_York")

sn49 <- fread("data/sn49filt.csv", sep = ",")
sn49$date <- ymd_hms(sn49$date, tz = "America/New_York")

sn62 <- read.csv("data/sn62filt.csv", header= TRUE)
sn62$date <- ymd_hms(sn62$date,  tz = "America/New_York")

sn67 <- read.csv("data/sn67filt.csv", header= TRUE)
sn67$date <- ymd_hms(sn67$date,  tz = "America/New_York")
```


# Give an overview of where pollution is coming from (Polar Plots & Percentile Plots)

```{r}
generate_overall_polarplots <- function(sn){
  #generates the polar plots for the variables we are interested in 
  polarPlot(sn, pollutant = "correctedNO")
  polarPlot(sn, pollutant = "no2model")
  polarPlot(sn, pollutant = "co")
  polarPlot(sn, pollutant = "bin0")
  polarPlot(sn, pollutant = "bin3")
  polarPlot(sn, pollutant = "bin5")
  polarPlot(sn, pollutant = "pm1")
  polarPlot(sn, pollutant = "pm25")
  polarPlot(sn, pollutant = "pm10")
  
  percentileRose(sn, pollutant = "correctedNO")
  percentileRose(sn, pollutant = "no2model")
  percentileRose(sn, pollutant = "co")
  percentileRose(sn, pollutant = "bin0")
  percentileRose(sn, pollutant = "bin3")
  percentileRose(sn, pollutant = "bin5"  )
  percentileRose(sn, pollutant = "pm1")
  percentileRose(sn, pollutant = "pm25" )
  percentileRose(sn, pollutant = "pm10")
}
```



```{r}
pdf("polar-percentile-plots-sn45.pdf")
generate_overall_polarplots(sn45)
dev.off()
```

```{r}
pdf("polar-percentile-plots-sn49.pdf")
generate_overall_polarplots(sn49)
dev.off()
```

```{r}
pdf("polar-percentile-plots-sn62.pdf")
generate_overall_polarplots(sn62)
dev.off()
```

```{r}
pdf("polar-percentile-plots-sn67.pdf")
generate_overall_polarplots(sn67)
dev.off()
```


# Describe Regimes 

## Importing Regimes 

I decided it would be best to import regimes as one list of datatables. Importing as a data.table takes a fourth of the amount of time as R's base read.csv function! 

```{r}
library(data.table)

sn45temp = list("sn45-reg1.csv", "sn45-reg2.csv", "sn45-reg3.csv", "sn45-reg4.csv") 
sn45regs = lapply(sn45temp, fread)
rm(sn45temp)

sn49temp = list("SN49-reg1.csv", "SN49-reg2.csv") 
sn49regs = lapply(sn49temp, fread)
rm(sn49temp)

sn62temp = list("SN62-reg1.csv", "SN62-reg2.csv") 
sn62regs = lapply(sn62temp, fread)
rm(sn62temp)

sn67temp = list("sn67-reg1.csv", "sn67-reg2.csv", "sn67-reg3.csv", "sn67-reg4.csv") 
sn67regs = lapply(sn67temp, fread)
rm(sn67temp)
```


## Percentage of data points in each regime 

```{r}
get_percentage <- function( reg1, reg2, reg3, reg4){
  
  reg1total <- nrow(reg1)
  reg2total <- nrow(reg2)
  reg3total <- nrow(reg3)
  reg4total <- nrow(reg4)
  total <- reg1total + reg2total + reg3total + reg4total
  
  cat(sprintf("Percent of Regime 1 : %f \n", (reg1total/ total)*100))
  cat(sprintf("Percent of Regime 2 : %f \n", (reg2total/ total)*100))
  cat(sprintf("Percent of Regime 3 : %f \n", (reg3total/ total)*100))
  cat(sprintf("Percent of Regime 4 : %f  \n", (reg4total/ total)*100))
  
  return(list("total" = total, "reg1total" = reg1total, "reg2total" = reg2total, "reg3total" = reg3total, "reg4total" = reg4total ))
  
}
```

```{r}
percents45 <- get_percentage(sn45regs[[1]], sn45regs[[2]], sn45regs[[3]], sn45regs[[4]])

```
```{r}
percents67 <- get_percentage(sn67regs[[1]], sn67regs[[2]], sn67regs[[3]], sn67regs[[4]])
```
## Polar Plots for Regimes 

```{r}
pdf("sn45-reg1-polarplots.pdf")
generate_overall_polarplots(sn45regs[[1]])
dev.off()
```

```{r}
pdf("sn45-reg2-polarplots.pdf")
generate_overall_polarplots(sn45regs[[2]])
dev.off()
```

```{r}
pdf("sn45-reg3-polarplots.pdf")
generate_overall_polarplots(sn45regs[[3]])
dev.off()
```

```{r}
pdf("sn45-reg4-polarplots.pdf")
generate_overall_polarplots(sn45regs[[4]])
dev.off()
```
```{r}
pdf("sn49-reg1-polarplots.pdf")
generate_overall_polarplots(sn49regs[[1]])
dev.off()
pdf("sn49-reg2-polarplots.pdf")
generate_overall_polarplots(sn49regs[[2]])
dev.off()

pdf("sn62-reg1-polarplots.pdf")
generate_overall_polarplots(sn62regs[[1]])
dev.off()
pdf("sn62-reg2-polarplots.pdf")
generate_overall_polarplots(sn62regs[[2]])
dev.off()

pdf("sn67-reg1-polarplots.pdf")
generate_overall_polarplots(sn67regs[[1]])
dev.off()
pdf("sn67-reg2-polarplots.pdf")
generate_overall_polarplots(sn67regs[[2]])
dev.off()
pdf("sn67-reg3-polarplots.pdf")
generate_overall_polarplots(sn67regs[[3]])
dev.off()
pdf("sn67-reg4-polarplots.pdf")
generate_overall_polarplots(sn67regs[[4]])
dev.off()
```

